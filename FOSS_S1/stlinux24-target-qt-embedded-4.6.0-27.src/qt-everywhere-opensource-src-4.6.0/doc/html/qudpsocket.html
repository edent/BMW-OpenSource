<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- qudpsocket.cpp -->
<head>
  <title>Qt 4.6: QUdpSocket Class Reference</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<a name="//apple_ref/cpp/cl//QUdpSocket" />
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><a href="http://qt.nokia.com/"><img src="images/qt-logo.png" align="left" border="0" /></a></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a>&nbsp;&middot; <a href="classes.html"><font color="#004faf">All&nbsp;Classes</font></a>&nbsp;&middot; <a href="functions.html"><font color="#004faf">All&nbsp;Functions</font></a>&nbsp;&middot; <a href="overviews.html"><font color="#004faf">Overviews</font></a></td></tr></table><h1 class="title">QUdpSocket Class Reference<br /><span class="small-subtitle">[<a href="qtnetwork.html">QtNetwork</a> module]</span>
</h1>
<p>The QUdpSocket class provides a UDP socket. <a href="#details">More...</a></p>
<pre> #include &lt;QUdpSocket&gt;</pre><p><b>This class is not part of the Qt GUI Framework Edition.</b></p>
<p>Inherits <a href="qabstractsocket.html">QAbstractSocket</a>.</p>
<p><b>Note:</b> All functions in this class are <a href="threads-reentrancy.html#reentrant">reentrant</a>.</p>
<ul>
<li><a href="qudpsocket-members.html">List of all members, including inherited members</a></li>
</ul>
<hr />
<a name="public-types"></a>
<h2>Public Types</h2>
<table class="alignedsummary" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td class="memItemLeft" align="right" valign="top">enum </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#BindFlag-enum">BindFlag</a></b> { ShareAddress, DontShareAddress, ReuseAddressHint, DefaultForPlatform }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">flags </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#BindFlag-enum">BindMode</a></b></td></tr>
</table>
<hr />
<a name="public-functions"></a>
<h2>Public Functions</h2>
<table class="alignedsummary" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td class="memItemLeft" align="right" valign="top"></td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#QUdpSocket">QUdpSocket</a></b> ( QObject * <i>parent</i> = 0 )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#dtor.QUdpSocket">~QUdpSocket</a></b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#bind">bind</a></b> ( const QHostAddress &amp; <i>address</i>, quint16 <i>port</i> )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#bind-2">bind</a></b> ( const QHostAddress &amp; <i>address</i>, quint16 <i>port</i>, BindMode <i>mode</i> )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#bind-3">bind</a></b> ( quint16 <i>port</i> = 0 )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#bind-4">bind</a></b> ( quint16 <i>port</i>, BindMode <i>mode</i> )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#hasPendingDatagrams">hasPendingDatagrams</a></b> () const</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qint64 </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#pendingDatagramSize">pendingDatagramSize</a></b> () const</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qint64 </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#readDatagram">readDatagram</a></b> ( char * <i>data</i>, qint64 <i>maxSize</i>, QHostAddress * <i>address</i> = 0, quint16 * <i>port</i> = 0 )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qint64 </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#writeDatagram">writeDatagram</a></b> ( const char * <i>data</i>, qint64 <i>size</i>, const QHostAddress &amp; <i>address</i>, quint16 <i>port</i> )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qint64 </td><td class="memItemRight" valign="bottom"><b><a href="qudpsocket.html#writeDatagram-2">writeDatagram</a></b> ( const QByteArray &amp; <i>datagram</i>, const QHostAddress &amp; <i>host</i>, quint16 <i>port</i> )</td></tr>
</table>
<ul>
<li><div bar="2" class="fn"></div>32 public functions inherited from <a href="qabstractsocket.html#public-functions">QAbstractSocket</a></li>
<li><div bar="2" class="fn"></div>33 public functions inherited from <a href="qiodevice.html#public-functions">QIODevice</a></li>
<li><div bar="2" class="fn"></div>29 public functions inherited from <a href="qobject.html#public-functions">QObject</a></li>
</ul>
<h3>Additional Inherited Members</h3>
<ul>
<li><div class="fn"></div>1 property inherited from <a href="qobject.html#properties">QObject</a></li>
<li><div class="fn"></div>1 public slot inherited from <a href="qobject.html#public-slots">QObject</a></li>
<li><div class="fn"></div>6 signals inherited from <a href="qabstractsocket.html#signals">QAbstractSocket</a></li>
<li><div class="fn"></div>4 signals inherited from <a href="qiodevice.html#signals">QIODevice</a></li>
<li><div class="fn"></div>1 signal inherited from <a href="qobject.html#signals">QObject</a></li>
<li><div class="fn"></div>5 static public members inherited from <a href="qobject.html#static-public-members">QObject</a></li>
<li><div class="fn"></div>10 protected functions inherited from <a href="qabstractsocket.html#protected-functions">QAbstractSocket</a></li>
<li><div class="fn"></div>5 protected functions inherited from <a href="qiodevice.html#protected-functions">QIODevice</a></li>
<li><div class="fn"></div>7 protected functions inherited from <a href="qobject.html#protected-functions">QObject</a></li>
<li><div class="fn"></div>2 protected slots inherited from <a href="qabstractsocket.html#protected-slots">QAbstractSocket</a></li>
</ul>
<a name="details"></a>
<hr />
<h2>Detailed Description</h2>
<p>The QUdpSocket class provides a UDP socket.</p>
<p>UDP (User Datagram Protocol) is a lightweight, unreliable, datagram-oriented, connectionless protocol. It can be used when reliability isn't important. QUdpSocket is a subclass of <a href="qabstractsocket.html">QAbstractSocket</a> that allows you to send and receive UDP datagrams.</p>
<p>The most common way to use this class is to bind to an address and port using <a href="qudpsocket.html#bind">bind</a>(), then call <a href="qudpsocket.html#writeDatagram">writeDatagram</a>() and <a href="qudpsocket.html#readDatagram">readDatagram</a>() to transfer data. If you want to use the standard <a href="qiodevice.html">QIODevice</a> functions <a href="qiodevice.html#read">read</a>(), <a href="qiodevice.html#readLine">readLine</a>(), <a href="qiodevice.html#write">write</a>(), etc., you must first connect the socket directly to a peer by calling <a href="qabstractsocket.html#connectToHost">connectToHost</a>().</p>
<p>The socket emits the <a href="qiodevice.html#bytesWritten">bytesWritten</a>() signal every time a datagram is written to the network. If you just want to send datagrams, you don't need to call <a href="qudpsocket.html#bind">bind</a>().</p>
<p>The <a href="qiodevice.html#readyRead">readyRead</a>() signal is emitted whenever datagrams arrive. In that case, <a href="qudpsocket.html#hasPendingDatagrams">hasPendingDatagrams</a>() returns true. Call <a href="qudpsocket.html#pendingDatagramSize">pendingDatagramSize</a>() to obtain the size of the first pending datagram, and <a href="qudpsocket.html#readDatagram">readDatagram</a>() to read it.</p>
<p><b>Note:</b> An incoming datagram should be read when you receive the <a href="qiodevice.html#readyRead">readyRead</a>() signal, otherwise this signal will not be emitted for the next datagram.</p>
<p>Example:</p>
<pre> void Server::initSocket()
 {
     udpSocket = new QUdpSocket(this);
     udpSocket-&gt;bind(QHostAddress::LocalHost, 7755);

     connect(udpSocket, SIGNAL(readyRead()),
             this, SLOT(readPendingDatagrams()));
 }

 void Server::readPendingDatagrams()
 {
     while (udpSocket-&gt;hasPendingDatagrams()) {
         QByteArray datagram;
         datagram.resize(udpSocket-&gt;pendingDatagramSize());
         QHostAddress sender;
         quint16 senderPort;

         udpSocket-&gt;readDatagram(datagram.data(), datagram.size(),
                                 &amp;sender, &amp;senderPort);

         processTheDatagram(datagram);
     }
 }</pre>
<p>With QUdpSocket, you can also establish a virtual connection to a UDP server using <a href="qabstractsocket.html#connectToHost">connectToHost</a>() and then use <a href="qiodevice.html#read">read</a>() and <a href="qiodevice.html#write">write</a>() to exchange datagrams without specifying the receiver for each datagram.</p>
<p>The <a href="network-broadcastsender.html">Broadcast Sender</a> and <a href="network-broadcastreceiver.html">Broadcast Receiver</a> examples illustrate how to use QUdpSocket in applications.</p>
<p>See also <a href="qtcpsocket.html">QTcpSocket</a>.</p>
<hr />
<h2>Member Type Documentation</h2>
<a name="//apple_ref/cpp/tag/QUdpSocket/BindFlag" />
<a name="//apple_ref/cpp/econst/QUdpSocket/ShareAddress" />
<a name="//apple_ref/cpp/econst/QUdpSocket/DontShareAddress" />
<a name="//apple_ref/cpp/econst/QUdpSocket/ReuseAddressHint" />
<a name="//apple_ref/cpp/econst/QUdpSocket/DefaultForPlatform" />
<a name="//apple_ref/cpp/tdef/QUdpSocket/BindMode" />
<h3 class="flags"><a name="BindFlag-enum"></a>enum QUdpSocket::BindFlag<br />flags QUdpSocket::BindMode</h3>
<p>This enum describes the different flags you can pass to modify the behavior of <a href="qudpsocket.html#bind">QUdpSocket::bind</a>().</p>
<p><b>Note:</b> On Symbian OS bind flags behaviour depends on process capabilties. If process has NetworkControl capability, the bind attempt with ReuseAddressHint will always succeed even if the address and port is already bound by another socket with any flags. If process does not have NetworkControl capability, the bind attempt to address and port already bound by another socket will always fail.</p>
<p><table class="valuelist" border="1" cellpadding="2" cellspacing="1" width="100%">
<tr><th width="25%">Constant</th><th width="15%">Value</th><th width="60%">Description</th></tr>
<tr><td valign="top"><tt>QUdpSocket::ShareAddress</tt></td><td align="center" valign="top"><tt>0x1</tt></td><td valign="top">Allow other services to bind to the same address and port. This is useful when multiple processes share the load of a single service by listening to the same address and port (e.g&#x2e;, a web server with several pre-forked listeners can greatly improve response time). However, because any service is allowed to rebind, this option is subject to certain security considerations. Note that by combining this option with ReuseAddressHint, you will also allow your service to rebind an existing shared address. On Unix, this is equivalent to the SO_REUSEADDR socket option. On Windows, this option is ignored.</td></tr>
<tr><td valign="top"><tt>QUdpSocket::DontShareAddress</tt></td><td align="center" valign="top"><tt>0x2</tt></td><td valign="top">Bind the address and port exclusively, so that no other services are allowed to rebind. By passing this option to <a href="qudpsocket.html#bind">QUdpSocket::bind</a>(), you are guaranteed that on successs, your service is the only one that listens to the address and port. No services are allowed to rebind, even if they pass ReuseAddressHint. This option provides more security than ShareAddress, but on certain operating systems, it requires you to run the server with administrator privileges. On Unix and Mac OS X, not sharing is the default behavior for binding an address and port, so this option is ignored. On Windows, this option uses the SO_EXCLUSIVEADDRUSE socket option.</td></tr>
<tr><td valign="top"><tt>QUdpSocket::ReuseAddressHint</tt></td><td align="center" valign="top"><tt>0x4</tt></td><td valign="top">Provides a hint to <a href="qudpsocket.html">QUdpSocket</a> that it should try to rebind the service even if the address and port are already bound by another socket. On Windows, this is equivalent to the SO_REUSEADDR socket option. On Unix, this option is ignored.</td></tr>
<tr><td valign="top"><tt>QUdpSocket::DefaultForPlatform</tt></td><td align="center" valign="top"><tt>0x0</tt></td><td valign="top">The default option for the current platform. On Unix and Mac OS X, this is equivalent to (DontShareAddress + ReuseAddressHint), and on Windows, its equivalent to ShareAddress.</td></tr>
</table></p>
<p>This enum was introduced in Qt 4.1.</p>
<p>The BindMode type is a typedef for <a href="qflags.html">QFlags</a>&lt;BindFlag&gt;. It stores an OR combination of BindFlag values.</p>
<hr />
<h2>Member Function Documentation</h2>
<a name="//apple_ref/cpp/instm/QUdpSocket/QUdpSocket" />
<h3 class="fn"><a name="QUdpSocket"></a>QUdpSocket::QUdpSocket ( <a href="qobject.html">QObject</a> * <i>parent</i> = 0 )</h3>
<p>Creates a <a href="qudpsocket.html">QUdpSocket</a> object.</p>
<p><i>parent</i> is passed to the <a href="qobject.html">QObject</a> constructor.</p>
<p>See also <a href="qabstractsocket.html#socketType">socketType</a>().</p>
<a name="//apple_ref/cpp/instm/QUdpSocket/~QUdpSocket" />
<h3 class="fn"><a name="dtor.QUdpSocket"></a>QUdpSocket::~QUdpSocket ()&nbsp;&nbsp;<tt> [virtual]</tt></h3>
<p>Destroys the socket, closing the connection if necessary.</p>
<p>See also <a href="qabstractsocket.html#close">close</a>().</p>
<a name="//apple_ref/cpp/instm/QUdpSocket/bind" />
<h3 class="fn"><a name="bind"></a>bool QUdpSocket::bind ( const <a href="qhostaddress.html">QHostAddress</a> &amp; <i>address</i>, <a href="qtglobal.html#quint16-typedef">quint16</a> <i>port</i> )</h3>
<p>Binds this socket to the address <i>address</i> and the port <i>port</i>. When bound, the signal <a href="qiodevice.html#readyRead">readyRead</a>() is emitted whenever a UDP datagram arrives on the specified address and port. This function is useful to write UDP servers.</p>
<p>On success, the functions returns true and the socket enters <a href="qabstractsocket.html#SocketState-enum">BoundState</a>; otherwise it returns false.</p>
<p>The socket is bound using the <a href="qudpsocket.html#BindFlag-enum">DefaultForPlatform</a> <a href="qudpsocket.html#BindFlag-enum">BindMode</a>.</p>
<p>See also <a href="qudpsocket.html#readDatagram">readDatagram</a>().</p>
<h3 class="fn"><a name="bind-2"></a>bool QUdpSocket::bind ( const <a href="qhostaddress.html">QHostAddress</a> &amp; <i>address</i>, <a href="qtglobal.html#quint16-typedef">quint16</a> <i>port</i>, <a href="qudpsocket.html#BindFlag-enum">BindMode</a> <i>mode</i> )</h3>
<p>This is an overloaded function.</p>
<p>Binds to <i>address</i> on port <i>port</i>, using the <a href="qudpsocket.html#BindFlag-enum">BindMode</a> <i>mode</i>.</p>
<p>This function was introduced in Qt 4.1.</p>
<h3 class="fn"><a name="bind-3"></a>bool QUdpSocket::bind ( <a href="qtglobal.html#quint16-typedef">quint16</a> <i>port</i> = 0 )</h3>
<p>This is an overloaded function.</p>
<p>Binds to <a href="qhostaddress.html">QHostAddress</a>:Any on port <i>port</i>.</p>
<h3 class="fn"><a name="bind-4"></a>bool QUdpSocket::bind ( <a href="qtglobal.html#quint16-typedef">quint16</a> <i>port</i>, <a href="qudpsocket.html#BindFlag-enum">BindMode</a> <i>mode</i> )</h3>
<p>This is an overloaded function.</p>
<p>Binds to <a href="qhostaddress.html">QHostAddress</a>:Any on port <i>port</i>, using the <a href="qudpsocket.html#BindFlag-enum">BindMode</a> <i>mode</i>.</p>
<p>This function was introduced in Qt 4.1.</p>
<a name="//apple_ref/cpp/instm/QUdpSocket/hasPendingDatagrams" />
<h3 class="fn"><a name="hasPendingDatagrams"></a>bool QUdpSocket::hasPendingDatagrams () const</h3>
<p>Returns true if at least one datagram is waiting to be read; otherwise returns false.</p>
<p>See also <a href="qudpsocket.html#pendingDatagramSize">pendingDatagramSize</a>() and <a href="qudpsocket.html#readDatagram">readDatagram</a>().</p>
<a name="//apple_ref/cpp/instm/QUdpSocket/pendingDatagramSize" />
<h3 class="fn"><a name="pendingDatagramSize"></a><a href="qtglobal.html#qint64-typedef">qint64</a> QUdpSocket::pendingDatagramSize () const</h3>
<p>Returns the size of the first pending UDP datagram. If there is no datagram available, this function returns -1.</p>
<p>See also <a href="qudpsocket.html#hasPendingDatagrams">hasPendingDatagrams</a>() and <a href="qudpsocket.html#readDatagram">readDatagram</a>().</p>
<a name="//apple_ref/cpp/instm/QUdpSocket/readDatagram" />
<h3 class="fn"><a name="readDatagram"></a><a href="qtglobal.html#qint64-typedef">qint64</a> QUdpSocket::readDatagram ( char * <i>data</i>, <a href="qtglobal.html#qint64-typedef">qint64</a> <i>maxSize</i>, <a href="qhostaddress.html">QHostAddress</a> * <i>address</i> = 0, <a href="qtglobal.html#quint16-typedef">quint16</a> * <i>port</i> = 0 )</h3>
<p>Receives a datagram no larger than <i>maxSize</i> bytes and stores it in <i>data</i>. The sender's host address and port is stored in *<i>address</i> and *<i>port</i> (unless the pointers are 0).</p>
<p>Returns the size of the datagram on success; otherwise returns -1.</p>
<p>If <i>maxSize</i> is too small, the rest of the datagram will be lost. To avoid loss of data, call <a href="qudpsocket.html#pendingDatagramSize">pendingDatagramSize</a>() to determine the size of the pending datagram before attempting to read it. If <i>maxSize</i> is 0, the datagram will be discarded.</p>
<p>See also <a href="qudpsocket.html#writeDatagram">writeDatagram</a>(), <a href="qudpsocket.html#hasPendingDatagrams">hasPendingDatagrams</a>(), and <a href="qudpsocket.html#pendingDatagramSize">pendingDatagramSize</a>().</p>
<a name="//apple_ref/cpp/instm/QUdpSocket/writeDatagram" />
<h3 class="fn"><a name="writeDatagram"></a><a href="qtglobal.html#qint64-typedef">qint64</a> QUdpSocket::writeDatagram ( const char * <i>data</i>, <a href="qtglobal.html#qint64-typedef">qint64</a> <i>size</i>, const <a href="qhostaddress.html">QHostAddress</a> &amp; <i>address</i>, <a href="qtglobal.html#quint16-typedef">quint16</a> <i>port</i> )</h3>
<p>Sends the datagram at <i>data</i> of size <i>size</i> to the host address <i>address</i> at port <i>port</i>. Returns the number of bytes sent on success; otherwise returns -1.</p>
<p>Datagrams are always written as one block. The maximum size of a datagram is highly platform-dependent, but can be as low as 8192 bytes. If the datagram is too large, this function will return -1 and <a href="qabstractsocket.html#error">error</a>() will return <a href="qabstractsocket.html#SocketError-enum">DatagramTooLargeError</a>.</p>
<p>Sending datagrams larger than 512 bytes is in general disadvised, as even if they are sent successfully, they are likely to be fragmented by the IP layer before arriving at their final destination.</p>
<p><b>Warning:</b> In S60 5.0 and earlier versions, the writeDatagram return value is not reliable for large datagrams.</p>
<p><b>Warning:</b> Calling this function on a connected UDP socket may result in an error and no packet being sent. If you are using a connected socket, use <a href="qiodevice.html#write">write</a>() to send datagrams.</p>
<p>See also <a href="qudpsocket.html#readDatagram">readDatagram</a>() and <a href="qiodevice.html#write">write</a>().</p>
<h3 class="fn"><a name="writeDatagram-2"></a><a href="qtglobal.html#qint64-typedef">qint64</a> QUdpSocket::writeDatagram ( const <a href="qbytearray.html">QByteArray</a> &amp; <i>datagram</i>, const <a href="qhostaddress.html">QHostAddress</a> &amp; <i>host</i>, <a href="qtglobal.html#quint16-typedef">quint16</a> <i>port</i> )</h3>
<p>This is an overloaded function.</p>
<p>Sends the datagram <i>datagram</i> to the host address <i>host</i> and at port <i>port</i>.</p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td width="40%" align="left">Copyright &copy; 2009 Nokia Corporation and/or its subsidiary(-ies)</td>
<td width="20%" align="center"><a href="trademarks.html">Trademarks</a></td>
<td width="40%" align="right"><div align="right">Qt 4.6.0</div></td>
</tr></table></div></address></body>
</html>
